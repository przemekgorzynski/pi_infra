version: '3.8'

networks: 
  tooling:
    external: true
    driver: bridge

services:
  prometheus:
    image: {{ prometheus_image }}
    container_name: {{ prometheus_container_name }}
    networks:
      - {{ docker_network }}
    ports:
      - {{ prometheus_host_port }}:{{ prometheus_container_port }}
    volumes:
      - {{ monitoring_directories[2] }}:/etc/prometheus
      - {{ monitoring_directories[3] }}:/prometheus
    restart: unless-stopped
    command:
      - "--config.file=/etc/prometheus/prometheus.yml"

#  grafana:
#    image: grafana/grafana:latest
#    container_name: grafana
#    ports:
#      - "3000:3000"
#    networks:
#      - tooling
#    volumes:
#      - "/monitoring/prometheus_grafana/grafana_data:/var/lib/grafana:rw"
#    restart: unless-stopped
#    labels:
#      - "traefik.enable=true"
#      - "traefik.http.routers.grafana.rule=Host(`grafana.pgorzynski.freeddns.org`)"
#      - "traefik.http.routers.grafana.entrypoints=websecure"
#      - "traefik.http.routers.grafana.tls.certresolver=production"